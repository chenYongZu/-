<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>博客系统注册</title>
    <!--
        <link rel="stylesheet" type="text/css" href="../CSS/login_css.css"/>
    -->
    <link type="text/css" rel="stylesheet" href="../CSS/registerbase.css" />
    <script src="../js/jquery-3.3.1.min.js"></script>
</head>

<body>
<script>
    $(document).ready(function () {
        $("#username").focus();
    })
</script>

<div class = "cyz_registerbox">
    <div class = "box">
        <div class = "container">
            <div class = "register_tip">
                用户注册
            </div>
            <div class = "register_form">
                <div class = "userbox">
                  <!--  <label for = "username"></label>-->
                    <input type = "text" name = "username" id = "username" placeholder = "账号昵称"/>
                </div>
                <div class = "passwdbox">
                    <!--<label for = "password"></label>-->
                    <input type = "password" name = "password" id = "password" placeholder = "密码"/>
                </div>
                <div class = "checkpasswdbox">
                    <!--<label for = "checkpassword"></label>-->
                    <input type = "password" name = "checkpassword" id = "checkpassword" placeholder = "确认密码"/>
                </div>
                <div class = "emailbox">
                    <!--<label for = "email"></label>-->
                    <input type = "text" name = "email" id = "email" placeholder = "电子邮箱"/>
                </div>
                <div class = "agebox">
                    <!--<label for = "email"></label>-->
                    <input type = "text" name = "age" id = "age" placeholder = "年龄"/>
                </div>
                <div class = "sexbox">
                    <select name="sex" id="sex">
                        <option>男</option>
                        <option>女</option>
                    </select>
                </div>
                <div class = "submitbox">
                    <button id="submit" name="submit">注册</button>
                </div>
                <div class = "forget-register">
                    <a href="login.html" class = "register">返回登录</a>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(function(){
        $("#submit").on("click",function(){
            var username = $("#username").val();
            var pwd = $("#password").val();
            var chkpwd = $("#checkpassword").val();
            var email = $("#email").val();
            var age = $("#age").val();
            var sex = $("#sex").val();
            var re = /^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/;
            if(username ==="" || pwd ==="" || chkpwd ==="" || email ===""){
                alert("NOT NULL");
            }
            else if(pwd.length <6){
                alert("密码长度太短");
            }
            else if(pwd !== chkpwd){
                alert("两次密码不一致");
            }
            else if(!re.test(email)){
                alert("邮箱格式不对");
            }
            else{
                if((escape(username).indexOf("%u") < 0)){
                    $.post("../php/register.php",{
                        "username":username,
                        "pwd":pwd,
                        "age":age,
                        "email":email,
                        "sex":sex
                    },function(data){
                        if(data==="Yes"){
                            $.post("../php/create_user.php",{
                                "username":username,
                                "pwd":pwd
                            },function(data_Y){
                                location = "login.html";
                            });
                        }else{
                            alert("用户名或者邮箱已被使用");
                        }
                    });
                }
                else{
                    alert("用户名不能有中文字符");
                }

            }
        });
    });
</script>
</body>



</html>